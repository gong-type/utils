# 目录树导出工具

导出目录的树形结构，支持设置搜索深度和忽略特定文件夹。

## 文件说明

| 文件 | 说明 |
|------|------|
| `Export-DirectoryTree.ps1` | 交互式命令行版本（完整功能） |
| `ExportTree-ContextMenu.ps1` | 右键菜单版本（GUI界面） |
| `Add-ExportTree-ContextMenu.reg` | 添加右键菜单 |
| `Remove-ExportTree-ContextMenu.reg` | 移除右键菜单 |

## 使用方式

### 方式一：右键菜单（推荐）

#### 安装
1. 复制脚本到 `C:\Scripts\` 目录：
```powershell
mkdir C:\Scripts -Force
copy ExportTree-ContextMenu.ps1 C:\Scripts\
```

2. 双击运行 `Add-ExportTree-ContextMenu.reg`，确认导入

#### 使用
- 在**文件夹**上右键 → 选择"输出结构树"
- 在文件夹**空白处**右键 → 选择"输出结构树"
- 弹出设置窗口，配置后点击"导出结构树"

#### 卸载
双击运行 `Remove-ExportTree-ContextMenu.reg`

### 方式二：命令行交互式

```powershell
powershell.exe -File "Export-DirectoryTree.ps1"
```

## 右键菜单版功能

### 设置选项
| 选项 | 说明 |
|------|------|
| 搜索深度 | 0 = 无限制，其他数字为最大层级 |
| 忽略文件夹 | 逗号分隔，如 `node_modules, .git` |
| 输出位置 | 目标目录 / 桌面 / 剪贴板 |
| 自动打开 | 导出后是否自动打开文件 |

### 默认忽略
```
node_modules, .git, bin, obj, .vs, dist, build, __pycache__
```

## 输出示例
```
目录树结构
生成时间: 2025-11-27 11:30:00
目标路径: C:\MyProject
搜索深度: 无限制
忽略文件夹: node_modules, .git
======================================

C:\MyProject
├── src\
│   ├── components\
│   │   └── App.tsx
│   └── index.ts
├── package.json
└── README.md
```

## 注意事项
- 脚本需要以 **UTF-16 LE** 编码保存才能在 PowerShell 5.1 正常运行
- 首次使用可能需要允许 PowerShell 执行策略
